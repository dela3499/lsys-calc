var clone,flatten,foundIn,getKeys,objectDiff,unique,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};flatten=function(a){" return array of all values in array (without any subarrays) ";var b,c,d,e;for(c=[],d=0,e=a.length;e>d;d++)b=a[d],b instanceof Array||b instanceof Object?c=c.concat(flatten(b)):c.push(b);return c},unique=function(a){" Return array without duplicate elements ";var b,c,d,e,f,g;for(c={},b=e=0,f=a.length;f>=0?f>e:e>f;b=f>=0?++e:--e)c[a[b]]=a[b];g=[];for(b in c)d=c[b],g.push(d);return g},getKeys=function(a){" Get all keys found in provided array of objects ";var b,c,d,e,f;for(c=[],e=0,f=a.length;f>e;e++){d=a[e];for(b in d)c.push(b)}return unique(c)},objectDiff=function(a,b){" Return array of top-level properties which differ between objects a and b ";var c,d,e,f,g;for(c=[],e=getKeys([a,b]),f=0,g=e.length;g>f;f++)d=e[f],a[d]instanceof Object&&b[d]instanceof Object?objectDiff(a[d],b[d]).length>0&&c.push(d):a[d]!==b[d]&&c.push(d);return flatten(c)},foundIn=function(a,b){" return true if any matches are found in array ";var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],__indexOf.call(b,c)>=0)return!0;return!1},clone=function(a){" Clone (deep copy) an object ";" http://coffeescriptcookbook.com/chapters/classes_and_objects/cloning ";var b,c,d;if(null==a||"object"!=typeof a)return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return b="",null!=a.global&&(b+="g"),null!=a.ignoreCase&&(b+="i"),null!=a.multiline&&(b+="m"),null!=a.sticky&&(b+="y"),new RegExp(a.source,b);d=new a.constructor;for(c in a)d[c]=clone(a[c]);return d};var Lsys;Lsys=function(){function a(a){return null==a&&(a={}),this.params=a,this.path=[],this.config={timeout:5},this.errors={compilation:!1,pathCreation:!1},this.compileRules(a),this.calcPath(),this}return a.prototype.isomorphic=function(a,b){" return true if n, rules, or seed properties differ between objects a and b ";return foundIn(["n","rules","seed"],objectDiff(a,b))},a.prototype.setParams=function(a){return null==a&&(a=this.params),this.isomorphic(a,this.params)||this.compileRules(a),this.params=a,this.calcPath(),this},a.prototype.compileRules=function(a){" Execute text-replacement on seed according to rules (repeated n times) ";var b,c,d,e,f,g,h;for(f=a.seed,e=(new Date).getTime(),d=g=1,h=a.n;h>=1?h>=g:g>=h;d=h>=1?++g:--g){if(b=(new Date).getTime(),(b-e)/1e3>this.config.timeout)return this.compiledString=f,void(this.errors.compilation="timeout");f=function(){var b,d,e;for(e=[],b=0,d=f.length;d>b;b++)c=f[b],e.push(a.rules[c]||c);return e}().join("")}return this.compiledString=f,this.errors.compilation=!1},a.prototype.getPath=function(){return this.path},a.prototype.calcPath=function(){" Generate path from compiled string and param values ";var a,b,c,d,e,f,g,h,i;for(f=clone(this.params.pose),f.stepSize=this.params.size.value,f.stepAngle=this.params.angle.value,b=[f.x],c=[f.y],d=[],e=(new Date).getTime(),i=this.compiledString,g=0,h=i.length;h>g&&(a=i[g],!(((new Date).getTime()-e)/1e3>this.config.timeout));g++)this.turtle(a,[f,this.params,b,c,d]);return this.path={x:b,y:c}},a.prototype.turtle=function(a,b){" return function to execute turtle graphics drawing command";var c;return c={F:function(a,b,c,d){" Move forward (in whatever direction you're facing) ";var e;return e=a.orientation%360*(Math.PI/180),a.x+=Math.cos(e)*a.stepSize,a.y+=Math.sin(e)*a.stepSize,c.push(a.x),d.push(a.y)},"+":function(a){return a.orientation+=a.stepAngle},"-":function(a){return a.orientation-=a.stepAngle},"|":function(a){return a.orientation+=180},"[":function(a,b,c,d,e){" Save current state for a later return ";return e.push(clone(a))},"]":function(a,b,c,d,e){" Return to last saved state ";var f,g;g=e.pop();for(f in g)a[f]=g[f];return c.push(a.x),d.push(a.y)},"!":function(a){return a.stepAngle*=-1},"(":function(a,b){return a.stepAngle*=1-b.angle.change},")":function(a,b){return a.stepAngle*=1+b.angle.change},"<":function(a,b){return a.stepSize*=1+b.size.change},">":function(a,b){return a.stepSize*=1-b.size.change}},c[a]?c[a].apply(c,b):null},a}();var data,e,params,path,sys,x,y,_i,_j,_len,_len1;for(console.log("-----------------\n Running test \n-----------------"),params={seed:"A",rules:{A:"F[+F]F",B:"ABF-F",C:"CABF[+F>+F]F"},n:1,pose:{x:0,y:0,orientation:0},size:{value:10,change:1},angle:{value:10,change:1}},sys=new Lsys(params),path=sys.getPath(),console.log(["heres a path",path]),x=function(){var a,b,c;for(c=[],a=0,b=path.length;b>a;a++)e=path[a],c.push(e.x);return c}(),y=function(){var a,b,c;for(c=[],a=0,b=path.length;b>a;a++)e=path[a],c.push(e.y);return c}(),_i=0,_len=path.length;_len>_i;_i++)data=path[_i],console.log(data.x);for(console.log(""),_j=0,_len1=path.length;_len1>_j;_j++)data=path[_j],console.log(data.y);console.log(""),console.log(sys.compiledString);