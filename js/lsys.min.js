(function(){var a,b,c,d,e,f,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=function(a){" return array of all values in array (without any subarrays) ";var c,d,e,f;for(d=[],e=0,f=a.length;f>e;e++)c=a[e],c instanceof Array||c instanceof Object?d=d.concat(b(c)):d.push(c);return d},f=function(a){" Return array without duplicate elements ";var b,c,d,e,f,g;for(c={},b=e=0,f=a.length;f>=0?f>e:e>f;b=f>=0?++e:--e)c[a[b]]=a[b];g=[];for(b in c)d=c[b],g.push(d);return g},d=function(a){" Get all keys found in provided array of objects ";var b,c,d,e,g;for(c=[],e=0,g=a.length;g>e;e++){d=a[e];for(b in d)c.push(b)}return f(c)},e=function(a,c){" Return array of top-level properties which differ between objects a and b ";var f,g,h,i,j;for(f=[],h=d([a,c]),console.log("ObjectDiff"),i=0,j=h.length;j>i;i++)g=h[i],console.log("ObjectDiff",[a,c]),a[g]instanceof Object&&c[g]instanceof Object?(console.log("ObjectDiff"),e(a[g],c[g]).length>0&&f.push(g)):a[g]!==c[g]&&f.push(g);return b(f)},c=function(a,b){" return true if any matches are found in array ";var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],g.call(b,c)>=0)return!0;return!1},a=function(b){" Clone (deep copy) an object ";" http://coffeescriptcookbook.com/chapters/classes_and_objects/cloning ";var c,d,e;if(null==b||"object"!=typeof b)return b;if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp)return c="",null!=b.global&&(c+="g"),null!=b.ignoreCase&&(c+="i"),null!=b.multiline&&(c+="m"),null!=b.sticky&&(c+="y"),new RegExp(b.source,c);e=new b.constructor;for(d in b)e[d]=a(b[d]);return e}}).call(this),function(){var a;a=function(){function a(a){return null==a&&(a={}),this.params=a,this.path=[],this.config={timeout:5},this.errors={compilation:!1,pathCreation:!1},this.compileRules(a),this.calcPath(),this}return a.prototype.isomorphic=function(a,b){" return true if n, rules, or seed properties differ between objects a and b ";return foundIn(["n","rules","seed"],objectDiff(a,b))},a.prototype.setParams=function(a){return null==a&&(a=this.params),this.isomorphic(a,this.params)||this.compileRules(a),this.params=a,this.calcPath(),this},a.prototype.compileRules=function(a){" Execute text-replacement on seed according to rules (repeated n times) ";var b,c,d,e,f,g,h;for(f=a.seed,e=(new Date).getTime(),d=g=1,h=a.n;h>=1?h>=g:g>=h;d=h>=1?++g:--g){if(b=(new Date).getTime(),(b-e)/1e3>this.config.timeout)return this.compiledString=f,void(this.errors.compilation="timeout");f=function(){var b,d,e;for(e=[],b=0,d=f.length;d>b;b++)c=f[b],e.push(a.rules[c]||c);return e}().join("")}return this.compiledString=f,this.errors.compilation=!1},a.prototype.getPath=function(){return this.path},a.prototype.calcPath=function(){" Generate path from compiled string and param values ";var a,b,c,d,e,f,g,h,i,j,k;for(f=clone(this.params.pose),f.stepSize=this.params.size.value,f.stepAngle=this.params.angle.value,c=[{x:f.x,y:f.y}],d=[],e=(new Date).getTime(),k=this.compiledString,i=0,j=k.length;j>i&&(a=k[i],!(((new Date).getTime()-e)/1e3>this.config.timeout));i++)this.turtle(a,[f,params,c,d]);return g=function(){var a,d,e;for(e=[],a=0,d=c.length;d>a;a++)b=c[a],e.push(b.x);return e}(),h=function(){var a,d,e;for(e=[],a=0,d=c.length;d>a;a++)b=c[a],e.push(b.y);return e}(),this.path={x:g,y:h}},a.prototype.turtle=function(a,b){" return function to execute turtle graphics drawing command";var c;return c={F:function(a,b,c){" Move forward (in whatever direction you're facing) ";var d;return d=a.orientation%360*(Math.PI/180),a.x+=Math.cos(d)*a.stepSize,a.y+=Math.sin(d)*a.stepSize,c.push({x:a.x,y:a.y})},"+":function(a){return a.orientation+=a.stepAngle},"-":function(a){return a.orientation-=a.stepAngle},"|":function(a){return a.orientation+=180},"[":function(a,b,c,d){" Save current state for a later return ";return d.push(clone(a))},"]":function(a,b,c,d){" Return to last saved state ";var e,f;f=d.pop();for(e in f)a[e]=f[e];return c.push({x:a.x,y:a.y})},"!":function(a){return a.stepAngle*=-1},"(":function(a,b){return a.stepAngle*=1-b.angle.change},")":function(a,b){return a.stepAngle*=1+b.angle.change},"<":function(a,b){return a.stepSize*=1+b.size.change},">":function(a,b){return a.stepSize*=1-b.size.change}},c[a]?c[a].apply(c,b):null},a}()}.call(this);